---
name: Capture Logs with Invalid UTF-8 Character
author: David Kopp
description: Test handling of invalid UTF-8 character in log output

services:
  test-container:
    image: alpine
    setup-commands:
      - command: 'printf "Setup log with invalid UTF-8 character: \xff embedded\n"'
    entrypoint: ["/bin/sh", "-c"]
    command: ['printf "Container log with invalid UTF-8 character: \xff embedded\n"; sleep infinity']
    log-stdout: true
    log-stderr: true

flow:
  - name: Flow with Null Bytes
    container: test-container
    commands:
      - type: console
        command: 'printf "Flow stdout with invalid UTF-8 character: \xff embedded\n" && printf "Flow stderr with invalid UTF-8 character: \xff embedded\n" >&2'
        shell: /bin/sh
        log-stdout: true
        log-stderr: true
